/*!
 * FooTable - Awesome Responsive Tables
 * Version : 2.0.1
 * http://fooplugins.com/plugins/footable-jquery/
 *
 * Requires jQuery - http://jquery.com/
 *
 * Copyright 2013 Steven Usher & Brad Vincent
 * Released under the MIT license
 * You are free to use FooTable in commercial projects as long as this copyright header is left intact.
 *
 * Date: 31 Aug 2013
 */

(function(e,t){function n(){var e=this;e.id=null,e.busy=!1,e.start=function(t,n){e.busy||(e.stop(),e.id=setTimeout(function(){t(),e.id=null,e.busy=!1},n),e.busy=!0)},e.stop=function(){null!==e.id&&(clearTimeout(e.id),e.id=null,e.busy=!1)}}function r(r,i,s){var o=this;o.id=s,o.table=r,o.options=i,o.breakpoints=[],o.breakpointNames="",o.columns={},o.plugins=t.footable.plugins.load(o);var u=o.options,f=u.classes,l=u.events,c=u.triggers,h=0;return o.timers={resize:new n,register:function(e){return o.timers[e]=new n,o.timers[e]}},o.init=function(){var n=e(t),r=e(o.table);if(t.footable.plugins.init(o),r.hasClass(f.loaded))return o.raise(l.alreadyInitialized),undefined;o.raise(l.initializing),r.addClass(f.loading),r.find(u.columnDataSelector).each(function(){var e=o.getColumnData(this);o.columns[e.index]=e});for(var i in u.breakpoints)o.breakpoints.push({name:i,width:u.breakpoints[i]}),o.breakpointNames+=i+" ";o.breakpoints.sort(function(e,t){return e.width-t.width}),r.bind(c.initialize,function(){r.removeData("footable_info"),r.data("breakpoint",""),r.trigger(c.resize),r.removeClass(f.loading),r.addClass(f.loaded).addClass(f.main),o.raise(l.initialized)}).bind(c.redraw,function(){o.redraw()}).bind(c.resize,function(){o.resize()}).bind(c.expandFirstRow,function(){r.find(u.toggleSelector).first().not("."+f.detailShow).trigger(c.toggleRow)}),r.trigger(c.initialize),n.bind("resize.footable",function(){o.timers.resize.stop(),o.timers.resize.start(function(){o.raise(c.resize)},u.delay)})},o.addRowToggle=function(){if(u.addRowToggle){var t=e(o.table),n=!1;t.find("span."+f.toggle).remove();for(var r in o.columns){var i=o.columns[r];if(i.toggle){n=!0;var s="> tbody > tr:not(."+f.detail+",."+f.disabled+") > td:nth-child("+(parseInt(i.index,10)+1)+")";return t.find(s).not("."+f.detailCell).prepend(e("<span />").addClass(f.toggle)),undefined}}n||t.find("> tbody > tr:not(."+f.detail+",."+f.disabled+") > td:first-child").not("."+f.detailCell).prepend(e("<span />").addClass(f.toggle))}},o.setColumnClasses=function(){$table=e(o.table);for(var t in o.columns){var n=o.columns[t];if(null!==n.className){var r="",i=!0;e.each(n.matches,function(e,t){i||(r+=", "),r+="> tbody > tr:not(."+f.detail+") > td:nth-child("+(parseInt(t,10)+1)+")",i=!1}),$table.find(r).not("."+f.detailCell).addClass(n.className)}}},o.bindToggleSelectors=function(){var t=e(o.table);o.hasAnyBreakpointColumn()&&(t.find(u.toggleSelector).unbind(c.toggleRow).bind(c.toggleRow,function(){var t=e(this).is("tr")?e(this):e(this).parents("tr:first");o.toggleDetail(t.get(0))}),t.find(u.toggleSelector).unbind("click.footable").bind("click.footable",function(n){t.is(".breakpoint")&&e(n.target).is("td,."+f.toggle)&&e(this).trigger(c.toggleRow)}))},o.parse=function(e,t){var n=u.parsers[t.type]||u.parsers.alpha;return n(e)},o.getColumnData=function(t){var n=e(t),r=n.data("hide"),i=n.index();r=r||"",r=jQuery.map(r.split(","),function(e){return jQuery.trim(e)});var s={index:i,hide:{},type:n.data("type")||"alpha",name:n.data("name")||e.trim(n.text()),ignore:n.data("ignore")||!1,toggle:n.data("toggle")||!1,className:n.data("class")||null,matches:[],names:{},group:n.data("group")||null,groupName:null};if(null!==s.group){var a=e(o.table).find('> thead > tr.footable-group-row > th[data-group="'+s.group+'"], > thead > tr.footable-group-row > td[data-group="'+s.group+'"]').first();s.groupName=o.parse(a,{type:"alpha"})}var f=parseInt(n.prev().attr("colspan")||0,10);h+=f>1?f-1:0;var c=parseInt(n.attr("colspan")||0,10),p=s.index+h;if(c>1){var d=n.data("names");d=d||"",d=d.split(",");for(var v=0;c>v;v++)s.matches.push(v+p),d.length>v&&(s.names[v+p]=d[v])}else s.matches.push(p);s.hide["default"]="all"===n.data("hide")||e.inArray("default",r)>=0;var m=!1;for(var g in u.breakpoints)s.hide[g]="all"===n.data("hide")||e.inArray(g,r)>=0,m=m||s.hide[g];s.hasBreakpoint=m;var y=o.raise(l.columnData,{column:{data:s,th:t}});return y.column.data},o.getViewportWidth=function(){return window.innerWidth||(document.body?document.body.offsetWidth:0)},o.calculateWidth=function(e,t){return jQuery.isFunction(u.calculateWidthOverride)?u.calculateWidthOverride(e,t):(t.viewportWidth<t.width&&(t.width=t.viewportWidth),t.parentWidth<t.width&&(t.width=t.parentWidth),t)},o.hasBreakpointColumn=function(e){for(var t in o.columns)if(o.columns[t].hide[e]){if(o.columns[t].ignore)continue;return!0}return!1},o.hasAnyBreakpointColumn=function(){for(var e in o.columns)if(o.columns[e].hasBreakpoint)return!0;return!1},o.resize=function(){var t=e(o.table);if(t.is(":visible")&&o.hasAnyBreakpointColumn()){var n={width:t.width(),viewportWidth:o.getViewportWidth(),parentWidth:t.parent().width()};n=o.calculateWidth(t,n);var r=t.data("footable_info");if(t.data("footable_info",n),o.raise(l.resizing,{old:r,info:n}),!r||r&&r.width&&r.width!==n.width){for(var i,s=null,u=0;o.breakpoints.length>u;u++)if(i=o.breakpoints[u],i&&i.width&&n.width<=i.width){s=i;break}var a=null===s?"default":s.name,f=o.hasBreakpointColumn(a),h=t.data("breakpoint");t.data("breakpoint",a).removeClass("default breakpoint").removeClass(o.breakpointNames).addClass(a+(f?" breakpoint":"")),a!==h&&(t.trigger(c.redraw),o.raise(l.breakpoint,{breakpoint:a,info:n}))}o.raise(l.resized,{old:r,info:n})}},o.redraw=function(){o.addRowToggle(),o.bindToggleSelectors(),o.setColumnClasses();var t=e(o.table),n=t.data("breakpoint"),r=o.hasBreakpointColumn(n);t.find("> tbody > tr:not(."+f.detail+")").data("detail_created",!1).end().find("> thead > tr:last-child > th").each(function(){var r=o.columns[e(this).index()],i="",s=!0;e.each(r.matches,function(e,t){s||(i+=", ");var n=t+1;i+="> tbody > tr:not(."+f.detail+") > td:nth-child("+n+")",i+=", > tfoot > tr:not(."+f.detail+") > td:nth-child("+n+")",i+=", > colgroup > col:nth-child("+n+")",s=!1}),i+=', > thead > tr[data-group-row="true"] > th[data-group="'+r.group+'"]';var u=t.find(i).add(this);if(r.hide[n]===!1?u.show():u.hide(),1===t.find("> thead > tr.footable-group-row").length){var l=t.find('> thead > tr:last-child > th[data-group="'+r.group+'"]:visible, > thead > tr:last-child > th[data-group="'+r.group+'"]:visible'),c=t.find('> thead > tr.footable-group-row > th[data-group="'+r.group+'"], > thead > tr.footable-group-row > td[data-group="'+r.group+'"]'),h=0;e.each(l,function(){h+=parseInt(e(this).attr("colspan")||1,10)}),h>0?c.attr("colspan",h).show():c.hide()}}).end().find("> tbody > tr."+f.detailShow).each(function(){o.createOrUpdateDetailRow(this)}),t.find("> tbody > tr."+f.detailShow+":visible").each(function(){var t=e(this).next();t.hasClass(f.detail)&&(r?t.show():t.hide())}),t.find("> thead > tr > th.footable-last-column, > tbody > tr > td.footable-last-column").removeClass("footable-last-column"),t.find("> thead > tr > th.footable-first-column, > tbody > tr > td.footable-first-column").removeClass("footable-first-column"),t.find("> thead > tr, > tbody > tr").find("> th:visible:last, > td:visible:last").addClass("footable-last-column").end().find("> th:visible:first, > td:visible:first").addClass("footable-first-column"),o.raise(l.redrawn)},o.toggleDetail=function(t){var n=t.jquery?t:e(t),r=n.next();n.hasClass(f.detailShow)?(n.removeClass(f.detailShow),r.hasClass(f.detail)&&r.hide(),o.raise(l.rowCollapsed,{row:n[0]})):(o.createOrUpdateDetailRow(n[0]),n.addClass(f.detailShow),n.next().show(),o.raise(l.rowExpanded,{row:n[0]}))},o.removeRow=function(t){var n=t.jquery?t:e(t);n.hasClass(f.detail)&&(n=n.prev());var r=n.next();n.data("detail_created")===!0&&r.remove(),n.remove(),o.raise(l.rowRemoved)},o.appendRow=function(t){var n=t.jquery?t:e(t);e(o.table).find("tbody").append(n),o.redraw()},o.getColumnFromTdIndex=function(t){var n=null;for(var r in o.columns)if(e.inArray(t,o.columns[r].matches)>=0){n=o.columns[r];break}return n},o.createOrUpdateDetailRow=function(t){var n,r=e(t),i=r.next(),s=[];if(r.data("detail_created")===!0)return!0;if(r.is(":hidden"))return!1;if(o.raise(l.rowDetailUpdating,{row:r,detail:i}),r.find("> td:hidden").each(function(){var t=e(this).index(),n=o.getColumnFromTdIndex(t),r=n.name;return n.ignore===!0?!0:(t in n.names&&(r=n.names[t]),s.push({name:r,value:o.parse(this,n),display:e.trim(e(this).html()),group:n.group,groupName:n.groupName}),!0)}),0===s.length)return!1;var a=r.find("> td:visible").length,c=i.hasClass(f.detail);return c||(i=e('<tr class="'+f.detail+'"><td class="'+f.detailCell+'"><div class="'+f.detailInner+'"></div></td></tr>'),r.after(i)),i.find("> td:first").attr("colspan",a),n=i.find("."+f.detailInner).empty(),u.createDetail(n,s,u.createGroupedDetail,u.detailSeparator,f),r.data("detail_created",!0),o.raise(l.rowDetailUpdated,{row:r,detail:i}),!c},o.raise=function(t,n){o.options.debug===!0&&e.isFunction(o.options.log)&&o.options.log(t,"event"),n=n||{};var r={ft:o};e.extend(!0,r,n);var i=e.Event(t,r);return i.ft||e.extend(!0,i,r),e(o.table).trigger(i),i},o.init(),o}t.footable={options:{delay:100,breakpoints:{phone:480,tablet:1024},parsers:{alpha:function(t){return e(t).data("value")||e.trim(e(t).text())},numeric:function(t){var n=e(t).data("value")||e(t).text().replace(/[^0-9.\-]/g,"");return n=parseFloat(n),isNaN(n)&&(n=0),n}},addRowToggle:!0,calculateWidthOverride:null,toggleSelector:" > tbody > tr:not(.footable-row-detail)",columnDataSelector:"> thead > tr:last-child > th, > thead > tr:last-child > td",detailSeparator:":",createGroupedDetail:function(e){for(var t={_none:{name:null,data:[]}},n=0;e.length>n;n++){var r=e[n].group;null!==r?(r in t||(t[r]={name:e[n].groupName||e[n].group,data:[]}),t[r].data.push(e[n])):t._none.data.push(e[n])}return t},createDetail:function(e,t,n,r,i){var s=n(t);for(var o in s)if(0!==s[o].data.length){"_none"!==o&&e.append('<div class="'+i.detailInnerGroup+'">'+s[o].name+"</div>");for(var u=0;s[o].data.length>u;u++){var a=s[o].data[u].name?r:"";e.append('<div class="'+i.detailInnerRow+'"><div class="'+i.detailInnerName+'">'+s[o].data[u].name+a+'</div><div class="'+i.detailInnerValue+'">'+s[o].data[u].display+"</div></div>")}}},classes:{main:"footable",loading:"footable-loading",loaded:"footable-loaded",toggle:"footable-toggle",disabled:"footable-disabled",detail:"footable-row-detail",detailCell:"footable-row-detail-cell",detailInner:"footable-row-detail-inner",detailInnerRow:"footable-row-detail-row",detailInnerGroup:"footable-row-detail-group",detailInnerName:"footable-row-detail-name",detailInnerValue:"footable-row-detail-value",detailShow:"footable-detail-show"},triggers:{initialize:"footable_initialize",resize:"footable_resize",redraw:"footable_redraw",toggleRow:"footable_toggle_row",expandFirstRow:"footable_expand_first_row"},events:{alreadyInitialized:"footable_already_initialized",initializing:"footable_initializing",initialized:"footable_initialized",resizing:"footable_resizing",resized:"footable_resized",redrawn:"footable_redrawn",breakpoint:"footable_breakpoint",columnData:"footable_column_data",rowDetailUpdating:"footable_row_detail_updating",rowDetailUpdated:"footable_row_detail_updated",rowCollapsed:"footable_row_collapsed",rowExpanded:"footable_row_expanded",rowRemoved:"footable_row_removed"},debug:!1,log:null},version:{major:0,minor:5,toString:function(){return t.footable.version.major+"."+t.footable.version.minor},parse:function(e){return version=/(\d+)\.?(\d+)?\.?(\d+)?/.exec(e),{major:parseInt(version[1],10)||0,minor:parseInt(version[2],10)||0,patch:parseInt(version[3],10)||0}}},plugins:{_validate:function(n){if(!e.isFunction(n))return t.footable.options.debug===!0&&console.error('Validation failed, expected type "function", received type "{0}".',typeof n),!1;var r=new n;return"string"!=typeof r.name?(t.footable.options.debug===!0&&console.error('Validation failed, plugin does not implement a string property called "name".',r),!1):e.isFunction(r.init)?(t.footable.options.debug===!0&&console.log('Validation succeeded for plugin "'+r.name+'".',r),!0):(t.footable.options.debug===!0&&console.error('Validation failed, plugin "'+r.name+'" does not implement a function called "init".',r),!1)},registered:[],register:function(n,r){t.footable.plugins._validate(n)&&(t.footable.plugins.registered.push(n),"object"==typeof r&&e.extend(!0,t.footable.options,r))},load:function(e){var n,r,i=[];for(r=0;t.footable.plugins.registered.length>r;r++)try{n=t.footable.plugins.registered[r],i.push(new n(e))}catch(s){t.footable.options.debug===!0&&console.error(s)}return i},init:function(e){for(var n=0;e.plugins.length>n;n++)try{e.plugins[n].init(e)}catch(r){t.footable.options.debug===!0&&console.error(r)}}}};var i=0;e.fn.footable=function(n){n=n||{};var s=e.extend(!0,{},t.footable.options,n);return this.each(function(){i++;var t=new r(this,s,i);e(this).data("footable",t)})}})(jQuery,window);